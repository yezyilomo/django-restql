
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../querying_data/">
      
      
        <link rel="next" href="../settings/">
      
      
      <link rel="icon" href="../img/favicon.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.15">
    
    
      
        <title>Mutating Data - Django RESTQL</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="teal">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#mutating-data" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Django RESTQL" class="md-header__button md-logo" aria-label="Django RESTQL" data-md-component="logo">
      
  <img src="../img/icon.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Django RESTQL
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Mutating Data
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/yezyilomo/django-restql/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    yezyilomo/django-restql
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Django RESTQL" class="md-nav__button md-logo" aria-label="Django RESTQL" data-md-component="logo">
      
  <img src="../img/icon.svg" alt="logo">

    </a>
    Django RESTQL
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/yezyilomo/django-restql/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    yezyilomo/django-restql
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Intro
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../querying_data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Querying Data
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Mutating Data
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Mutating Data
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#using-nestedfield-and-nestedmodelserializer" class="md-nav__link">
    <span class="md-ellipsis">
      Using NestedField and NestedModelSerializer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#self-referencing-nested-field" class="md-nav__link">
    <span class="md-ellipsis">
      Self referencing nested field
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nestedfield-kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      NestedField kwargs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NestedField kwargs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#accept_pk-kwarg" class="md-nav__link">
    <span class="md-ellipsis">
      accept_pk kwarg
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#accept_pk_only-kwarg" class="md-nav__link">
    <span class="md-ellipsis">
      accept_pk_only kwarg
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create_ops-and-update_ops-kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      create_ops and update_ops kwargs.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#allow_remove_all-kwarg" class="md-nav__link">
    <span class="md-ellipsis">
      allow_remove_all kwarg
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_on_null-kwarg" class="md-nav__link">
    <span class="md-ellipsis">
      delete_on_null kwarg
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-dynamicfieldsmixin-and-nestedfield-together" class="md-nav__link">
    <span class="md-ellipsis">
      Using DynamicFieldsMixin and NestedField together
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#working-with-data-mutation-without-request" class="md-nav__link">
    <span class="md-ellipsis">
      Working with data mutation without request
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Settings
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../license/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    License
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#using-nestedfield-and-nestedmodelserializer" class="md-nav__link">
    <span class="md-ellipsis">
      Using NestedField and NestedModelSerializer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#self-referencing-nested-field" class="md-nav__link">
    <span class="md-ellipsis">
      Self referencing nested field
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nestedfield-kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      NestedField kwargs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NestedField kwargs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#accept_pk-kwarg" class="md-nav__link">
    <span class="md-ellipsis">
      accept_pk kwarg
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#accept_pk_only-kwarg" class="md-nav__link">
    <span class="md-ellipsis">
      accept_pk_only kwarg
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create_ops-and-update_ops-kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      create_ops and update_ops kwargs.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#allow_remove_all-kwarg" class="md-nav__link">
    <span class="md-ellipsis">
      allow_remove_all kwarg
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_on_null-kwarg" class="md-nav__link">
    <span class="md-ellipsis">
      delete_on_null kwarg
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-dynamicfieldsmixin-and-nestedfield-together" class="md-nav__link">
    <span class="md-ellipsis">
      Using DynamicFieldsMixin and NestedField together
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#working-with-data-mutation-without-request" class="md-nav__link">
    <span class="md-ellipsis">
      Working with data mutation without request
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="mutating-data">Mutating Data<a class="headerlink" href="#mutating-data" title="Permanent link">&para;</a></h1>
<p><strong>Django RESTQL</strong> got your back on creating and updating nested data too, it has two components for mutating nested data, <code>NestedModelSerializer</code> and <code>NestedField</code>. A serializer <code>NestedModelSerializer</code> has <code>update</code> and <code>create</code> logics for nested fields on the other hand <code>NestedField</code> is used to validate data before calling <code>update</code> or <code>create</code> method.</p>
<h2 id="using-nestedfield-and-nestedmodelserializer">Using NestedField and NestedModelSerializer<a class="headerlink" href="#using-nestedfield-and-nestedmodelserializer" title="Permanent link">&para;</a></h2>
<p>Just like in querying data, mutating nested data with <strong>Django RESTQL</strong> is very simple, you just have to inherit <code>NestedModelSerializer</code> on a serializer with nested fields and use <code>NestedField</code> to define those nested fields which you want to be able to mutate. Below is an example which shows how to use <code>NestedModelSerializer</code> and <code>NestedField</code>.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">rest_framework</span><span class="w"> </span><span class="kn">import</span> <span class="n">serializers</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django_restql.serializers</span><span class="w"> </span><span class="kn">import</span> <span class="n">NestedModelSerializer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django_restql.fields</span><span class="w"> </span><span class="kn">import</span> <span class="n">NestedField</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">app.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Location</span><span class="p">,</span> <span class="n">Amenity</span><span class="p">,</span> <span class="n">Property</span>


<span class="k">class</span><span class="w"> </span><span class="nc">LocationSerializer</span><span class="p">(</span><span class="n">serializers</span><span class="o">.</span><span class="n">ModelSerializer</span><span class="p">):</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Location</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;city&quot;</span><span class="p">,</span> <span class="s2">&quot;country&quot;</span><span class="p">]</span>


<span class="k">class</span><span class="w"> </span><span class="nc">AmenitySerializer</span><span class="p">(</span><span class="n">serializers</span><span class="o">.</span><span class="n">ModelSerializer</span><span class="p">):</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Amenity</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">]</span>


<span class="c1"># Inherit NestedModelSerializer to support create and update </span>
<span class="c1"># on nested fields</span>
<span class="k">class</span><span class="w"> </span><span class="nc">PropertySerializer</span><span class="p">(</span><span class="n">NestedModelSerializer</span><span class="p">):</span>
    <span class="c1"># Define location as nested field</span>
    <span class="n">location</span> <span class="o">=</span> <span class="n">NestedField</span><span class="p">(</span><span class="n">LocationSerializer</span><span class="p">)</span>

    <span class="c1"># Define amenities as nested field</span>
    <span class="n">amenities</span> <span class="o">=</span> <span class="n">NestedField</span><span class="p">(</span><span class="n">AmenitySerializer</span><span class="p">,</span> <span class="n">many</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Property</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">,</span> <span class="s1">&#39;location&#39;</span><span class="p">,</span> <span class="s1">&#39;amenities&#39;</span>
        <span class="p">]</span>
</code></pre></div>

<p>With serializers defined as shown above, you will be able to send data mutation request like</p>
<p><code>POST /api/property/</code></p>
<p>With a request body like</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="s2">&quot;price&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">60000</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;location&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="s2">&quot;city&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Newyork&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;country&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;USA&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="s2">&quot;amenities&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="s2">&quot;add&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="mf">3</span><span class="p">],</span>
<span class="w">        </span><span class="s2">&quot;create&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Watererr&quot;</span><span class="p">},</span>
<span class="w">            </span><span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Electricity&quot;</span><span class="p">}</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>And get a response as</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;price&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">60000</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;location&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">3</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;city&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Newyork&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;country&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;USA&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="s2">&quot;amenities&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;name&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Watererr&quot;</span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;name&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Electricity&quot;</span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;name&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Swimming Pool&quot;</span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>

<p>Just to clarify what happed here:</p>
<ul>
<li>location has been created and associated with the property created</li>
<li><code>create</code> operation has created amenities with values specified in a list and associate them with the property</li>
<li><code>add</code> operation has added amenity with id=3 to a list of amenities of the property.</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>POST for many related fields supports two operations which are <code>create</code> and <code>add</code>.</p>
</div>
<p><br></p>
<p>Below we have an example where we are trying to update the property we have created in the previous example.</p>
<p><code>PUT/PATCH /api/property/2/</code></p>
<p>Request Body</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="s2">&quot;price&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">50000</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;location&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="s2">&quot;city&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Newyork&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;country&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;USA&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="s2">&quot;amenities&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="s2">&quot;add&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="mf">4</span><span class="p">],</span>
<span class="w">        </span><span class="s2">&quot;create&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">[{</span><span class="s2">&quot;name&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Fance&quot;</span><span class="p">}],</span>
<span class="w">        </span><span class="s2">&quot;remove&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="mf">3</span><span class="p">],</span>
<span class="w">        </span><span class="s2">&quot;update&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="mf">1</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Water&quot;</span><span class="p">}}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>After sending the requst above we'll get a response which looks like</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;price&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">50000</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;location&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">3</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;city&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Newyork&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;country&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;USA&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="s2">&quot;amenities&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;name&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Water&quot;</span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;name&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Electricity&quot;</span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">4</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;name&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Bathtub&quot;</span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">5</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;name&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Fance&quot;</span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>

<p>From the request body <code>add</code>, <code>create</code>, <code>remove</code> and <code>update</code> are operations</p>
<p>What you see in the response above are details of our property, what really happened after sending the update request is</p>
<ul>
<li><code>add</code> operation added amenitiy with id=4 to a list of amenities of the property</li>
<li><code>create</code> operation created amenities with values specified in a list</li>
<li><code>remove</code> operation removed amenities with id=3 from a property</li>
<li><code>update</code> operation updated amenity with id=1 according to values specified.</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>PUT/PATCH for many related fields supports four operations which are <code>create</code>, <code>add</code>, <code>remove</code> and <code>update</code>.</p>
</div>
<h2 id="self-referencing-nested-field">Self referencing nested field<a class="headerlink" href="#self-referencing-nested-field" title="Permanent link">&para;</a></h2>
<p>Currently DRF doesn't allow declaring self referencing nested fields but you might have a self referencing nested field in your project since Django allows creating them. Django RESTQL comes with a nice way to deal with this scenario.</p>
<p>Let's assume we have a student model as shows below</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># models.py</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Student</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">age</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">()</span>
    <span class="n">study_partners</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ManyToManyField</span><span class="p">(</span><span class="s1">&#39;self&#39;</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s1">&#39;study_partners&#39;</span><span class="p">)</span>
</code></pre></div>

<p>As you can see from the model above <code>study_partners</code> is a self referencing field. Below is the corresponding serializer for our model</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># serializers.py</span>

<span class="k">class</span><span class="w"> </span><span class="nc">StudentSerializer</span><span class="p">(</span><span class="n">NestedModelSerializer</span><span class="p">):</span>
    <span class="c1"># Define study_partners as self referencing nested field</span>
    <span class="n">study_partners</span> <span class="o">=</span> <span class="n">NestedField</span><span class="p">(</span>
        <span class="s1">&#39;self&#39;</span><span class="p">,</span>
        <span class="n">many</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;study_partners&#39;</span><span class="p">]</span>
    <span class="p">)</span>

    <span class="k">class</span><span class="w"> </span><span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Student</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;study_partners&#39;</span><span class="p">]</span>
</code></pre></div>

<p>You can see that we have passed <code>self</code> to <code>NestedField</code> just like in <code>Student</code> model, this means that <code>study_partners</code> field is a self referencing field.</p>
<p>The other important thing here is <code>exclude=['study_partners']</code>, this excludes the field <code>study_partners</code> on a nested field to avoid recursion error if the self reference is cyclic.</p>
<h2 id="nestedfield-kwargs">NestedField kwargs<a class="headerlink" href="#nestedfield-kwargs" title="Permanent link">&para;</a></h2>
<p><code>NestedField</code> accepts extra kwargs in addition to those accepted by a serializer, these extra kwargs can be used to do more customizations on a nested field as explained below.</p>
<h3 id="accept_pk-kwarg">accept_pk kwarg<a class="headerlink" href="#accept_pk-kwarg" title="Permanent link">&para;</a></h3>
<p><code>accept_pk=True</code> is used if you want to be able to update nested field by using pk/id of existing data(basically associate existing nested resource with the parent resource). This applies to foreign key relations only. The default value for <code>accept_pk</code> is <code>False</code>.</p>
<p>Below is an example showing how to use <code>accept_pk</code> kwarg.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">rest_framework</span><span class="w"> </span><span class="kn">import</span> <span class="n">serializers</span> 
<span class="kn">from</span><span class="w"> </span><span class="nn">django_restql.fields</span><span class="w"> </span><span class="kn">import</span> <span class="n">NestedField</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django_restql.serializers</span><span class="w"> </span><span class="kn">import</span> <span class="n">NestedModelSerializer</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">app.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Location</span><span class="p">,</span> <span class="n">Property</span>


<span class="k">class</span><span class="w"> </span><span class="nc">LocationSerializer</span><span class="p">(</span><span class="n">serializers</span><span class="o">.</span><span class="n">ModelSerializer</span><span class="p">):</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Location</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;city&quot;</span><span class="p">,</span> <span class="s2">&quot;country&quot;</span><span class="p">]</span>


<span class="k">class</span><span class="w"> </span><span class="nc">PropertySerializer</span><span class="p">(</span><span class="n">NestedModelSerializer</span><span class="p">):</span>
    <span class="c1"># pk based nested field</span>
    <span class="n">location</span> <span class="o">=</span> <span class="n">NestedField</span><span class="p">(</span><span class="n">LocationSerializer</span><span class="p">,</span> <span class="n">accept_pk</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Property</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">,</span> <span class="s1">&#39;location&#39;</span>
        <span class="p">]</span>
</code></pre></div>

<p>Now sending mutation request as</p>
<p><code>POST /api/property/</code></p>
<p>Request Body</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="s2">&quot;price&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">40000</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;location&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">2</span>
<span class="p">}</span>
</code></pre></div>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Here location resource with id=2 exists already, so what's done here is create a new property resource and associate it with this location whose id is 2.</p>
</div>
<p>Response</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;price&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">40000</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;location&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;city&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Tokyo&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;country&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;China&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>Using <code>accept_pk</code> doesn't limit you from sending data(instead of pk to nested resource), setting <code>accept_pk=True</code> means you can send both data and pks. For instance from the above example you could still do </p>
<p><code>POST /api/property/</code></p>
<p>Request Body</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="s2">&quot;price&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">63000</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;location&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="s2">&quot;city&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Dodoma&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;country&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Tanzania&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>Response</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;price&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">63000</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;location&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">3</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;city&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Dodoma&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;country&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Tanzania&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="accept_pk_only-kwarg">accept_pk_only kwarg<a class="headerlink" href="#accept_pk_only-kwarg" title="Permanent link">&para;</a></h3>
<p><code>accept_pk_only=True</code> is used if you want to be able to update nested field by using pk/id only. This applies to foreign key relations only as well. The default value for <code>accept_pk_only</code> kwarg is <code>False</code>, if <code>accept_pk_only=True</code> is set you won't be able to send data to create a nested resource.</p>
<p>Below is an example showing how to use <code>accept_pk_only</code> kwarg.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">rest_framework</span><span class="w"> </span><span class="kn">import</span> <span class="n">serializers</span> 
<span class="kn">from</span><span class="w"> </span><span class="nn">django_restql.fields</span><span class="w"> </span><span class="kn">import</span> <span class="n">NestedField</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django_restql.serializers</span><span class="w"> </span><span class="kn">import</span> <span class="n">NestedModelSerializer</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">app.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Location</span><span class="p">,</span> <span class="n">Property</span>


<span class="k">class</span><span class="w"> </span><span class="nc">LocationSerializer</span><span class="p">(</span><span class="n">serializers</span><span class="o">.</span><span class="n">ModelSerializer</span><span class="p">):</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Location</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;city&quot;</span><span class="p">,</span> <span class="s2">&quot;country&quot;</span><span class="p">]</span>


<span class="k">class</span><span class="w"> </span><span class="nc">PropertySerializer</span><span class="p">(</span><span class="n">NestedModelSerializer</span><span class="p">):</span>
    <span class="c1"># pk based nested field</span>
    <span class="n">location</span> <span class="o">=</span> <span class="n">NestedField</span><span class="p">(</span><span class="n">LocationSerializer</span><span class="p">,</span> <span class="n">accept_pk_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Property</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">,</span> <span class="s1">&#39;location&#39;</span>
        <span class="p">]</span>
</code></pre></div>

<p>Sending mutation request</p>
<p><code>POST /api/property/</code></p>
<p>Request Body</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="s2">&quot;price&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">40000</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;location&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">2</span><span class="w">  </span><span class="c1">// You can&#39;t send data in here, you can only send pk/id</span>
<span class="p">}</span>
</code></pre></div>

<p>Response</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;price&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">40000</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;location&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;city&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Tokyo&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;country&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;China&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By default <code>accept_pk=False</code> and <code>accept_pk_only=False</code>, so nested field(foreign key related) accepts data only by default, if <code>accept_pk=True</code> is set, it accepts data and pk/id, and if <code>accept_pk_only=True</code> is set it accepts pk/id only. You can't set both <code>accept_pk=True</code> and <code>accept_pk_only=True</code>.</p>
</div>
<h3 id="create_ops-and-update_ops-kwargs">create_ops and update_ops kwargs.<a class="headerlink" href="#create_ops-and-update_ops-kwargs" title="Permanent link">&para;</a></h3>
<p>These two kwargs are used to restrict some operations when creating or updating nested data. Below is an example showing how to restrict some operations by using these two kwargs.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">rest_framework</span><span class="w"> </span><span class="kn">import</span> <span class="n">serializers</span> 
<span class="kn">from</span><span class="w"> </span><span class="nn">django_restql.fields</span><span class="w"> </span><span class="kn">import</span> <span class="n">NestedField</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django_restql.serializers</span><span class="w"> </span><span class="kn">import</span> <span class="n">NestedModelSerializer</span> 

<span class="kn">from</span><span class="w"> </span><span class="nn">app.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Location</span><span class="p">,</span> <span class="n">Amenity</span><span class="p">,</span> <span class="n">Property</span>


<span class="k">class</span><span class="w"> </span><span class="nc">AmenitySerializer</span><span class="p">(</span><span class="n">serializers</span><span class="o">.</span><span class="n">ModelSerializer</span><span class="p">):</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Amenity</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">]</span>


<span class="k">class</span><span class="w"> </span><span class="nc">PropertySerializer</span><span class="p">(</span><span class="n">NestedModelSerializer</span><span class="p">):</span>
    <span class="n">amenities</span> <span class="o">=</span> <span class="n">NestedField</span><span class="p">(</span>
        <span class="n">AmenitySerializer</span><span class="p">,</span> 
        <span class="n">many</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">create_ops</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;add&quot;</span><span class="p">],</span>  <span class="c1"># Allow only add operation</span>
        <span class="n">update_ops</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;add&quot;</span><span class="p">,</span> <span class="s2">&quot;remove&quot;</span><span class="p">]</span>  <span class="c1"># Allow only add and remove operations</span>
    <span class="p">)</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Property</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">,</span> <span class="s1">&#39;amenities&#39;</span>
        <span class="p">]</span>
</code></pre></div>

<p>Sending create mutation request</p>
<p><code>POST /api/property/</code></p>
<p>Request Body</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="s2">&quot;price&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">60000</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;amenities&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="s2">&quot;add&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since <code>create_ops=["add"]</code>, you can't use <code>create</code> operation in here!.</p>
</div>
<p>Response</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;price&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">60000</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;amenities&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;name&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Watererr&quot;</span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;name&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Electricity&quot;</span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>

<p>Sending update mutation request</p>
<p><code>PUT/PATCH /api/property/2/</code></p>
<p>Request Body</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="s2">&quot;price&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">50000</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;amenities&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="s2">&quot;add&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="mf">3</span><span class="p">],</span>
<span class="w">        </span><span class="s2">&quot;remove&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="mf">2</span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since <code>update_ops=["add", "remove"]</code>, you can't use <code>create</code> or <code>update</code> operation in here!.</p>
</div>
<p>Response</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;price&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">50000</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;amenities&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;name&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Water&quot;</span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;name&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Bathtub&quot;</span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="allow_remove_all-kwarg">allow_remove_all kwarg<a class="headerlink" href="#allow_remove_all-kwarg" title="Permanent link">&para;</a></h3>
<p>This kwarg is used to enable and disable removing all related objects on many related nested field at once by using <code>__all__</code> directive. The default value of <code>allow_remove_all</code> is <code>False</code>, which means removing all related objects on many related nested fields is disabled by default so if you want to enable it you must set its value to <code>True</code>. For example </p>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CourseSerializer</span><span class="p">(</span><span class="n">NestedModelSerializer</span><span class="p">):</span>
    <span class="n">books</span> <span class="o">=</span> <span class="n">NestedField</span><span class="p">(</span><span class="n">BookSerializer</span><span class="p">,</span> <span class="n">many</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">allow_remove_all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">class</span><span class="w"> </span><span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Course</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;code&quot;</span><span class="p">,</span> <span class="s2">&quot;books&quot;</span><span class="p">]</span>
</code></pre></div>

<p>With <code>allow_remove_all=True</code> as set above you will be able to send a request like</p>
<p><code>PUT/PATCH /courses/3/</code></p>
<p>Request Body</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="s2">&quot;books&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="s2">&quot;remove&quot;</span><span class="o">:</span><span class="w">  </span><span class="s2">&quot;__all__&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>This will remove all books associated with a course being updated.
<br></p>
<h3 id="delete_on_null-kwarg">delete_on_null kwarg<a class="headerlink" href="#delete_on_null-kwarg" title="Permanent link">&para;</a></h3>
<p>When dealing with nested fields, there are scenarios where the previously assigned object or resource is no longer needed after the field is cleared (i.e. set to <code>null</code>). In such cases, passing <code>delete_on_null=True</code> kwarg enables automatic deletion of the previously assigned resource when the nested field is explicitly updated to <code>null</code>.</p>
<p>This keyword argument applies only to <code>ForeignKey</code> or <code>OneToOne</code> relationships.
The default value for <code>delete_on_null</code> kwarg is <code>False</code>.</p>
<p>Below is an example showing how to use <code>delete_on_null</code> kwarg.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">rest_framework</span><span class="w"> </span><span class="kn">import</span> <span class="n">serializers</span> 
<span class="kn">from</span><span class="w"> </span><span class="nn">django_restql.fields</span><span class="w"> </span><span class="kn">import</span> <span class="n">NestedField</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django_restql.serializers</span><span class="w"> </span><span class="kn">import</span> <span class="n">NestedModelSerializer</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">app.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Location</span><span class="p">,</span> <span class="n">Property</span>


<span class="k">class</span><span class="w"> </span><span class="nc">LocationSerializer</span><span class="p">(</span><span class="n">serializers</span><span class="o">.</span><span class="n">ModelSerializer</span><span class="p">):</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Location</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;city&quot;</span><span class="p">,</span> <span class="s2">&quot;country&quot;</span><span class="p">]</span>


<span class="k">class</span><span class="w"> </span><span class="nc">PropertySerializer</span><span class="p">(</span><span class="n">NestedModelSerializer</span><span class="p">):</span>
    <span class="n">location</span> <span class="o">=</span> <span class="n">NestedField</span><span class="p">(</span><span class="n">LocationSerializer</span><span class="p">,</span> <span class="n">delete_on_null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Property</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">,</span> <span class="s1">&#39;location&#39;</span>
        <span class="p">]</span>
</code></pre></div>

<p>Assuming we have a property with this structure</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;price&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">30000</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;location&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">5</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;city&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Arusha&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;country&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Tanzania&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>Sending a mutation request to update this property by removing a location</p>
<p><code>PUT/PATCH  /api/property/1/</code></p>
<p>Request Body</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="s2">&quot;location&quot;</span><span class="o">:</span><span class="w"> </span><span class="kc">null</span>
<span class="p">}</span>
</code></pre></div>

<p>Response</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;price&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">30000</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;location&quot;</span><span class="o">:</span><span class="w"> </span><span class="kc">null</span>
<span class="p">}</span>
</code></pre></div>

<p>In this case, the property’s location is updated to null, and the previously assigned Location instance (with id: 5) is deleted from the database.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code>delete_on_null=True</code> can only be used when both <code>accept_pk=False</code> and <code>accept_pk_only=False</code>. This is because <code>accept_pk=True</code> or <code>accept_pk_only=True</code> typically implies that the nested object is not tightly coupled to the parent and may be referenced elsewhere. Automatically deleting it in such cases could lead to unintended side effects or broken references.</p>
</div>
<h2 id="using-dynamicfieldsmixin-and-nestedfield-together">Using DynamicFieldsMixin and NestedField together<a class="headerlink" href="#using-dynamicfieldsmixin-and-nestedfield-together" title="Permanent link">&para;</a></h2>
<p>You can use <code>DynamicFieldsMixin</code> and <code>NestedModelSerializer</code> together if you want your serializer to be writable(on nested fields) and support querying data, this is very common. Below is an example which shows how you can use <code>DynamicFieldsMixin</code> and <code>NestedField</code> together.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">rest_framework</span><span class="w"> </span><span class="kn">import</span> <span class="n">serializers</span> 
<span class="kn">from</span><span class="w"> </span><span class="nn">django_restql.fields</span><span class="w"> </span><span class="kn">import</span> <span class="n">NestedField</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django_restql.mixins</span><span class="w"> </span><span class="kn">import</span> <span class="n">DynamicFieldsMixin</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django_restql.serializers</span><span class="w"> </span><span class="kn">import</span> <span class="n">NestedModelSerializer</span> 

<span class="kn">from</span><span class="w"> </span><span class="nn">app.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Location</span><span class="p">,</span> <span class="n">Property</span>


<span class="k">class</span><span class="w"> </span><span class="nc">LocationSerializer</span><span class="p">(</span><span class="n">DynamicFieldsMixin</span><span class="p">,</span> <span class="n">serializers</span><span class="o">.</span><span class="n">ModelSerializer</span><span class="p">):</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Location</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;city&quot;</span><span class="p">,</span> <span class="s2">&quot;country&quot;</span><span class="p">]</span>

<span class="c1"># Inherit both DynamicFieldsMixin and NestedModelSerializer</span>
<span class="k">class</span><span class="w"> </span><span class="nc">PropertySerializer</span><span class="p">(</span><span class="n">DynamicFieldsMixin</span><span class="p">,</span> <span class="n">NestedModelSerializer</span><span class="p">):</span>
    <span class="n">location</span> <span class="o">=</span> <span class="n">NestedField</span><span class="p">(</span><span class="n">LocationSerializer</span><span class="p">)</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Property</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">,</span> <span class="s1">&#39;location&#39;</span>
        <span class="p">]</span>
</code></pre></div>

<p><code>NestedField</code> is nothing but a serializer wrapper, it returns an instance of a modified version of a serializer passed, so you can pass all the args and kwargs accepted by a serializer on it, it will simply pass them along to a serializer passed when instantiating an instance. So you can pass anything accepted by a serializer to a <code>NestedField</code> wrapper, and if a serializer passed inherits <code>DynamicFieldsMixin</code> just like <code>LocationSerializer</code> on the example above then you can pass any arg or kwarg accepted by <code>DynamicFieldsMixin</code> when defining location as a nested field, i.e</p>
<div class="codehilite"><pre><span></span><code><span class="n">location</span> <span class="o">=</span> <span class="n">NestedField</span><span class="p">(</span><span class="n">LocationSerializer</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="o">...</span><span class="p">])</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">location</span> <span class="o">=</span> <span class="n">NestedField</span><span class="p">(</span><span class="n">LocationSerializer</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="o">...</span><span class="p">])</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">location</span> <span class="o">=</span> <span class="n">NestedField</span><span class="p">(</span><span class="n">LocationSerializer</span><span class="p">,</span> <span class="n">return_pk</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to use <code>required=False</code> kwarg on <code>NestedField</code> you might want to include <code>allow_null=True</code> too if you want your nested field to be set to <code>null</code> if you haven't supplied it. For example </p>
</div>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">rest_framework</span><span class="w"> </span><span class="kn">import</span> <span class="n">serializers</span> 
<span class="kn">from</span><span class="w"> </span><span class="nn">django_restql.fields</span><span class="w"> </span><span class="kn">import</span> <span class="n">NestedField</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django_restql.mixins</span><span class="w"> </span><span class="kn">import</span> <span class="n">DynamicFieldsMixin</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django_restql.serializers</span><span class="w"> </span><span class="kn">import</span> <span class="n">NestedModelSerializer</span> 

<span class="kn">from</span><span class="w"> </span><span class="nn">app.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Location</span><span class="p">,</span> <span class="n">Property</span>


<span class="k">class</span><span class="w"> </span><span class="nc">LocationSerializer</span><span class="p">(</span><span class="n">serializers</span><span class="o">.</span><span class="n">ModelSerializer</span><span class="p">):</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Location</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;city&quot;</span><span class="p">,</span> <span class="s2">&quot;country&quot;</span><span class="p">]</span>


<span class="k">class</span><span class="w"> </span><span class="nc">PropertySerializer</span><span class="p">(</span><span class="n">NestedModelSerializer</span><span class="p">):</span>
    <span class="c1"># Passing both `required=False` and `allow_null=True`</span>
    <span class="n">location</span> <span class="o">=</span> <span class="n">NestedField</span><span class="p">(</span><span class="n">LocationSerializer</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Property</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">,</span> <span class="s1">&#39;location&#39;</span>
        <span class="p">]</span>
</code></pre></div>

<p>The <code>required=False</code> kwarg allows you to create Property without including <code>location</code> field and the <code>allow_null=True</code> kwarg allows <code>location</code> field to be set to null if you haven't supplied it. For example</p>
<p>Sending mutation request</p>
<p><code>POST /api/property/</code></p>
<p>Request Body</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="s2">&quot;price&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">40000</span>
<span class="w">    </span><span class="c1">// You can see that the location is not included here</span>
<span class="p">}</span>
</code></pre></div>

<p>Response</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;price&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">50000</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;location&quot;</span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="w">  </span><span class="c1">// This is the result of not including location</span>
<span class="p">}</span>
</code></pre></div>

<p>If you use <code>required=False</code> only without <code>allow_null=True</code>, The serializer will allow you to create Property without including <code>location</code> field but it will throw error because by default <code>allow_null=False</code> which means <code>null</code>/<code>None</code>(which is what's passed when you don't supply <code>location</code> value) is not considered a valid value.</p>
<h2 id="working-with-data-mutation-without-request">Working with data mutation without request<a class="headerlink" href="#working-with-data-mutation-without-request" title="Permanent link">&para;</a></h2>
<p><strong>Django RESTQL</strong> allows you to do data mutation without having request object, this is used if you don't want to get your mutation data input(serializer data) from a request, in fact <code>NestedModelSerializer</code> and <code>NestedFied</code> can work independently without using request. Below is an example showing how you can work with data mutation without request object.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">rest_framework</span><span class="w"> </span><span class="kn">import</span> <span class="n">serializers</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django_restql.fields</span><span class="w"> </span><span class="kn">import</span> <span class="n">NestedField</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django_restql.mixins</span><span class="w"> </span><span class="kn">import</span> <span class="n">DynamicFieldsMixin</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django_restql.serializers</span><span class="w"> </span><span class="kn">import</span> <span class="n">NestedModelSerializer</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">app.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Book</span><span class="p">,</span> <span class="n">Course</span>


<span class="k">class</span><span class="w"> </span><span class="nc">BookSerializer</span><span class="p">(</span><span class="n">DynamicFieldsMixin</span><span class="p">,</span> <span class="n">NestedModelSerializer</span><span class="p">):</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Book</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;author&#39;</span><span class="p">]</span>


<span class="k">class</span><span class="w"> </span><span class="nc">CourseSerializer</span><span class="p">(</span><span class="n">DynamicFieldsMixin</span><span class="p">,</span> <span class="n">NestedModelSerializer</span><span class="p">):</span>
    <span class="n">books</span> <span class="o">=</span> <span class="n">NestedField</span><span class="p">(</span><span class="n">BookSerializer</span><span class="p">,</span> <span class="n">many</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Course</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;code&#39;</span><span class="p">,</span> <span class="s1">&#39;books&#39;</span><span class="p">]</span>
</code></pre></div>

<p>From serializers above you can create a course like</p>
<div class="codehilite"><pre><span></span><code><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Computer Programming&quot;</span><span class="p">,</span>
    <span class="s2">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;CS50&quot;</span><span class="p">,</span>
    <span class="s2">&quot;books&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;add&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
        <span class="s2">&quot;create&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span><span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Basic Data Structures&#39;</span><span class="p">,</span> <span class="s1">&#39;author&#39;</span><span class="p">:</span> <span class="s1">&#39;J. Davis&#39;</span><span class="p">},</span>
            <span class="p">{</span><span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Advanced Data Structures&#39;</span><span class="p">,</span> <span class="s1">&#39;author&#39;</span><span class="p">:</span> <span class="s1">&#39;S. Mobit&#39;</span><span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">serializer</span> <span class="o">=</span> <span class="n">CourseSerializer</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
<span class="n">serializer</span><span class="o">.</span><span class="n">is_valid</span><span class="p">()</span>
<span class="n">serializer</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">serializer</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># This will print</span>
<span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Computer Programming&quot;</span><span class="p">,</span>
    <span class="s2">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;CS50&quot;</span><span class="p">,</span>
    <span class="s2">&quot;books&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Programming Intro&#39;</span><span class="p">,</span> <span class="s1">&#39;author&#39;</span><span class="p">:</span> <span class="s1">&#39;K. Moses&#39;</span><span class="p">},</span>
        <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Understanding Computers&#39;</span><span class="p">,</span> <span class="s1">&#39;author&#39;</span><span class="p">:</span> <span class="s1">&#39;B. Gibson&#39;</span><span class="p">},</span>
        <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Basic Data Structures&#39;</span><span class="p">,</span> <span class="s1">&#39;author&#39;</span><span class="p">:</span> <span class="s1">&#39;J. Davis&#39;</span><span class="p">},</span>
        <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Advanced Data Structures&#39;</span><span class="p">,</span> <span class="s1">&#39;author&#39;</span><span class="p">:</span> <span class="s1">&#39;S. Mobit&#39;</span><span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</code></pre></div>

<p>To update a created course you can do it like</p>
<div class="codehilite"><pre><span></span><code><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;CS100&quot;</span><span class="p">,</span>
    <span class="s2">&quot;books&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;remove&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">course_obj</span> <span class="o">=</span> <span class="n">Course</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">serializer</span> <span class="o">=</span> <span class="n">CourseSerializer</span><span class="p">(</span><span class="n">course_obj</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
<span class="n">serializer</span><span class="o">.</span><span class="n">is_valid</span><span class="p">()</span>
<span class="n">serializer</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">serializer</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># This will print</span>
<span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Computer Programming&quot;</span><span class="p">,</span>
    <span class="s2">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;CS100&quot;</span><span class="p">,</span>
    <span class="s2">&quot;books&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Programming Intro&#39;</span><span class="p">,</span> <span class="s1">&#39;author&#39;</span><span class="p">:</span> <span class="s1">&#39;K. Moses&#39;</span><span class="p">},</span>
        <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Understanding Computers&#39;</span><span class="p">,</span> <span class="s1">&#39;author&#39;</span><span class="p">:</span> <span class="s1">&#39;B. Gibson&#39;</span><span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.56ea9cef.min.js"></script>
      
    
  </body>
</html>